---
description: 학습 패턴 기록 규칙
globs: **/*
alwaysApply: true
---

# Learning Patterns

Agent Portal 프로젝트에서 학습 내용을 축적하고 활용하는 규칙입니다.

## 개요

**핵심 원칙**: 모든 작업에서 학습한 내용을 성문화하여 AI가 학습하고 반복적인 실수를 방지

**학습 디렉토리**: `.cursor/learnings/`
- `ui-patterns.md` — UI 개발 학습 내용
- `api-patterns.md` — API 개발 학습 내용
- `bug-fixes.md` — 버그 수정 학습 내용
- `preferences.md` — 개발자 선호도 기록

---

## 학습 내용 기록 시점

### 작업 완료 후 (5-10분)

**항상 기록**:
- 새로운 패턴 발견
- 버그 수정 방법
- 실패한 접근법 (다음에 반복하지 않기 위해)
- 사용자 피드백 ("이거 싫어함" / "잘 잡았어")

**Git hook 자동 기록** (설치 후):
- `post-commit`: 커밋 메시지에서 학습 내용 추출
- `.cursor/learnings/` 디렉토리에 자동 분류 저장

---

## 학습 내용 기록 형식

### UI 패턴 학습

**파일**: `.cursor/learnings/ui-patterns.md`

**형식**:
```markdown
## YYYY-MM-DD: 제목

**요청**: 사용자 요청 내용
**적용**: 적용한 패턴/방법
**피드백**: ✅ 잘 잡았어 / ❌ 이거 싫어함
**재사용**: 향후 유사 작업 시 적용 방법
**참고**: 관련 파일 경로, 커밋 해시 등

---
```

**예시**:
```markdown
## 2025-11-12: 탭 스타일 변경

**요청**: monitoring 페이지의 탭 버튼 스타일 변경
**적용**: border-b-2 → rounded-lg 버튼 (bg-[#0072CE] 활성 상태)
**피드백**: ✅ 잘 잡았어 (모던한 디자인)
**재사용**: 향후 모든 탭 네비게이션에 동일 패턴 적용
**참고**: 
- webui/src/routes/(app)/admin/monitoring/+page.svelte (line 72-101)
- commit abc123

---
```

### API 패턴 학습

**파일**: `.cursor/learnings/api-patterns.md`

**형식**:
```markdown
## YYYY-MM-DD: 제목

**요청**: 사용자 요청 내용
**적용**: 적용한 패턴/방법
**피드백**: ✅ 잘 잡았어 / ❌ 이거 싫어함
**재사용**: 향후 유사 작업 시 적용 방법
**참고**: 관련 파일 경로, 커밋 해시 등

---
```

**예시**:
```markdown
## 2025-11-12: API 에러 핸들링 개선

**요청**: Chat API 에러 핸들링 개선
**적용**: FastAPI HTTPException + 타임아웃 30초
**피드백**: ✅ 잘 잡았어 (안정성 향상)
**재사용**: 모든 외부 호출에 타임아웃 설정 필수
**참고**: 
- backend/app/routes/chat.py (line 45-67)
- commit def456

---
```

### 버그 수정 학습

**파일**: `.cursor/learnings/bug-fixes.md`

**형식**:
```markdown
## YYYY-MM-DD: 버그 제목

**증상**: 버그 발생 상황 및 에러 메시지
**근본 원인**: 버그 발생 근본 원인
**해결 방법**: 적용한 해결 방법
**예방**: 향후 동일 버그 방지 방법
**참고**: 관련 파일 경로, 커밋 해시 등

---
```

**예시**:
```markdown
## 2025-11-12: Monitoring 페이지 API 타임아웃

**증상**: 
- Monitoring 페이지 로딩 시 "Failed to load usage summary: TypeError: Failed to fetch" 에러
- 브라우저 콘솔에 네트워크 오류

**근본 원인**: 
- API 호출 시 타임아웃 미설정
- 에러 핸들링 미적용
- 네트워크 오류 시 사용자에게 에러 메시지 노출

**해결 방법**: 
- AbortController로 5초 타임아웃 설정
- try/catch로 에러 핸들링
- 네트워크 오류 시 샘플 데이터 사용 (graceful degradation)

**예방**: 
- API 호출 시 항상 타임아웃 설정
- 에러 핸들링 필수
- 사용자 친화적 에러 메시지

**참고**: 
- webui/src/routes/(app)/admin/monitoring/+page.svelte (line 150-180)
- commit ghi789

---
```

### 선호도 기록

**파일**: `.cursor/learnings/preferences.md`

**형식**:
```markdown
## YYYY-MM-DD: 선호도 제목

**상황**: 선호도 발생 상황
**피드백**: ✅ 잘 잡았어 / ❌ 이거 싫어함
**이유**: 피드백 이유
**향후 적용**: 다음 유사 결정 시 적용 방법

---
```

**예시 1 (긍정적 피드백)**:
```markdown
## 2025-11-12: 탭 스타일 모던화

**상황**: monitoring 페이지 탭 버튼 스타일 변경
**피드백**: ✅ 잘 잡았어
**이유**: border-b-2 대신 rounded-lg 버튼이 더 모던하고 사용자 친화적
**향후 적용**: 모든 탭 네비게이션에 rounded-lg 버튼 스타일 적용

---
```

**예시 2 (부정적 피드백)**:
```markdown
## 2025-11-10: 다크 모드 강제 적용

**상황**: UI 테마를 다크 모드로 강제 적용
**피드백**: ❌ 이거 싫어함
**이유**: Samsung Life 브랜딩은 밝은 색상 (라이트 테마)
**향후 적용**: 라이트 테마를 기본으로 사용, 다크 모드 클래스는 유지하되 강제 적용하지 않음

---
```

---

## 학습 내용 기록 방법

### 방법 1: 자동 기록 (Git Hook)

**설치**:
```bash
# Git hooks 설치
./scripts/install-git-hooks.sh

# 또는 수동 설치
cp .githooks/* .git/hooks/
chmod +x .git/hooks/*
```

**사용**:
```bash
# 커밋 메시지에 학습 내용 포함
git commit -m "feat(ui): monitoring 페이지 탭 스타일 변경

- border-b-2 → rounded-lg 버튼으로 변경
- bg-[#0072CE] 활성 상태 스타일 적용

Learning: 탭 스타일은 border-b-2 대신 rounded-lg 버튼으로 변경하는 것이 더 모던함
"

# post-commit hook이 자동으로 학습 내용 추출 및 기록
```

### 방법 2: 수동 기록 (스크립트)

**사용**:
```bash
# 카테고리, 제목, 내용 지정
./scripts/record-learning.sh "UI" "탭 스타일 변경" "border-b-2 대신 rounded-lg 버튼으로 변경하는 것이 더 모던함"

# 카테고리 옵션:
# - "UI" → .cursor/learnings/ui-patterns.md
# - "API" → .cursor/learnings/api-patterns.md
# - "BUG" → .cursor/learnings/bug-fixes.md
# - "PREF" → .cursor/learnings/preferences.md
```

### 방법 3: 직접 파일 수정

**사용**:
```bash
# 파일 직접 수정
vim .cursor/learnings/ui-patterns.md

# 또는 echo로 추가
echo "## $(date +%Y-%m-%d): 탭 스타일 변경

**요청**: monitoring 페이지의 탭 버튼 스타일 변경
**적용**: border-b-2 → rounded-lg 버튼
**피드백**: ✅ 잘 잡았어 (모던한 디자인)
**재사용**: 향후 모든 탭 네비게이션에 동일 패턴 적용

---
" >> .cursor/learnings/ui-patterns.md
```

---

## 학습 내용 활용

### AI 에이전트가 학습 내용 참조

**Cursor AI**:
- `.cursorrules` 파일에 학습 디렉토리 명시
- AI가 유사 작업 시 자동으로 학습 내용 참조
- "이거 싫어함" 패턴 자동 회피
- "잘 잡았어" 패턴 우선 적용

**예시**:
```
# .cursorrules (해당 내용 포함됨)
## 학습 축적 시스템

### 자동 학습 기록
- `.cursor/learnings/` 디렉토리의 학습 내용 참조
- "이거 싫어함" 패턴 회피
- "잘 잡았어" 패턴 우선 적용
```

### 주간 리뷰 (매주 금요일)

**목적**: 학습 내용을 핵심 문서에 통합

**절차**:
```bash
# 주간 리뷰 스크립트 실행
./scripts/weekly-review.sh

# 스크립트가 수행하는 작업:
# 1. .cursor/learnings/ 디렉토리의 학습 내용 확인
# 2. 반복되는 패턴을 핵심 문서에 통합
# 3. 가드레일 업데이트 (새로운 실패 사례 발견 시)
# 4. 선호도 기록 검토 및 반영
```

**통합 대상 문서**:
- `CLAUDE.md` — 가드레일, 코딩 표준
- `AGENTS.md` — 에이전트 워크플로우
- `.cursorrules` — AI 코딩 가이드라인
- `.cursor/rules/` — 특화 규칙 파일

---

## 학습 내용 기록 체크리스트

### 작업 완료 후 반드시 확인

- [ ] 새로운 패턴 발견 여부
- [ ] 버그 수정 방법
- [ ] 실패한 접근법 (다음에 반복하지 않기 위해)
- [ ] 사용자 피드백 ("이거 싫어함" / "잘 잡았어")
- [ ] `.cursor/learnings/` 디렉토리에 기록
- [ ] Git commit 메시지에 학습 내용 포함 (선택)

---

## Git 히스토리에서 학습 내용 추출

### 과거 학습 내용 추출

**사용**:
```bash
# Git 히스토리에서 학습 내용 추출
./scripts/extract-learnings.sh

# 스크립트가 수행하는 작업:
# 1. Git 커밋 메시지에서 "Learning:" 키워드 검색
# 2. 학습 내용 추출 및 분류
# 3. .cursor/learnings/ 디렉토리에 자동 기록
```

**커밋 메시지 형식** (권장):
```
feat(ui): monitoring 페이지 탭 스타일 변경

- border-b-2 → rounded-lg 버튼으로 변경
- bg-[#0072CE] 활성 상태 스타일 적용

Learning: 탭 스타일은 border-b-2 대신 rounded-lg 버튼으로 변경하는 것이 더 모던함
```

---

## 학습 내용 검색

### 키워드로 학습 내용 검색

**사용**:
```bash
# 키워드로 학습 내용 검색
grep -r "탭 스타일" .cursor/learnings/

# 카테고리별 검색
grep -r "✅ 잘 잡았어" .cursor/learnings/ui-patterns.md
grep -r "❌ 이거 싫어함" .cursor/learnings/preferences.md
```

### 날짜별 학습 내용 검색

**사용**:
```bash
# 날짜별 학습 내용 검색
grep -r "2025-11-12" .cursor/learnings/

# 최근 1주일 학습 내용
find .cursor/learnings/ -type f -mtime -7 -exec cat {} \;
```

---

## 학습 내용 통합

### 핵심 문서 업데이트

**시점**: 주간 리뷰 시 (매주 금요일)

**절차**:
1. **반복 패턴 식별**:
   ```bash
   # 반복되는 키워드 확인
   grep -r "재사용:" .cursor/learnings/ | sort | uniq -c | sort -nr
   ```

2. **가드레일 업데이트** (실패 사례 발견 시):
   ```markdown
   # CLAUDE.md에 추가
   ### 문제 X: [문제 제목]
   
   **증상**: [버그 발생 상황]
   
   **해결** (대안 제시):
   - **방법 1**: [해결 방법 1]
   - **방법 2**: [해결 방법 2]
   - **방법 3**: [해결 방법 3]
   ```

3. **코딩 표준 업데이트** (새로운 패턴 발견 시):
   ```markdown
   # .cursor/rules/ui-development.mdc에 추가
   ### [패턴 제목]
   
   **권장 패턴**:
   ```svelte
   <!-- 새로운 패턴 -->
   ```
   
   **사용 이유**: [이유]
   **재사용**: [적용 방법]
   ```

4. **문서 동기화**:
   ```bash
   # 문서 동기화 스크립트 실행
   ./scripts/sync-docs.sh
   ```

---

## 참고 자료

- [Planning-Centric AI Coding](https://news.hada.io/topic?id=24266) — AI에게 시니어 엔지니어처럼 생각하도록 가르치기
- [Cursor AI 사용 가이드](https://news.hada.io/topic?id=24099) — "Shoot and Forget" 방법론
